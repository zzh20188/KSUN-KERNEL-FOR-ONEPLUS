name: å·¥ä½œæµä¾‹å­1
run-name: ${{ github.actor }} æ­£åœ¨æµ‹è¯• GitHub Actions ğŸš€
permissions:
  contents: write  # Allow writing to repository contents (for pushing tags)
  actions: write   # Allows triggering actions
on:
  workflow_dispatch:
 
jobs:
  test_job:
    runs-on: ubuntu-22.04
    env:
      CCACHE_COMPILERCHECK: "%compiler% -dumpmachine; %compiler% -dumpversion"
      CCACHE_NOHASHDIR: "true"
      CCACHE_HARDLINK: "true"
      CI: "false"
    #   MODEL: ${{ inputs.phone == 'å°ç±³10' && 'Mi10' || 'MI10PRO' }} 
    steps:
      - run: echo "ğŸ‰ è¯¥ä»»åŠ¡è‡ªåŠ¨è§¦å‘äº ${{ github.event_name }} äº‹ä»¶."
      - run: echo "${{ inputs.m }}-${{ inputs.gki }}-${{ inputs.model }}"

      - name: åˆ›å»ºå‡ ä¸ªæ–‡ä»¶ç”¨äºæµ‹è¯•
        run: |
          mkdir -p work/out/dist
          cd work/out/dist
          # åˆ›å»º boot.img æ–‡ä»¶ï¼Œå¤§å°ä¸º 514KB
          dd if=/dev/zero of=boot.img bs=1K count=514
          # åˆ›å»º boot-gz.img æ–‡ä»¶ï¼Œå¤§å°ä¸º 514KB
          dd if=/dev/zero of=boot-gz.img bs=1K count=514
          # åˆ›å»º boot-lz4.img æ–‡ä»¶ï¼Œå¤§å°ä¸º 514KB
          dd if=/dev/zero of=boot-lz4.img bs=1K count=514
          # åˆ›å»º Image æ–‡ä»¶ï¼Œå¤§å°ä¸º 514KB
          dd if=/dev/zero of=Image bs=1K count=514
          # åˆ›å»º Image.gz æ–‡ä»¶ï¼Œå¤§å°ä¸º 514KB
          dd if=/dev/zero of=Image.gz bs=1K count=514
          # åˆ›å»º Image.lz4 æ–‡ä»¶ï¼Œå¤§å°ä¸º 514KB
          dd if=/dev/zero of=Image.lz4 bs=1K count=514


      - name: ä¸Šä¼ Imageé•œåƒï¼ˆéœ€è¦æ‰‹åŠ¨æ›¿æ¢åˆ°åˆ·å…¥åŒ…ï¼‰
        uses: actions/upload-artifact@v4
        with:
          name: ${{ inputs.m }}-Image.zip
          path: |
            work/out/dist/Image
            work/out/dist/Image.gz
            work/out/dist/Image.lz4
      - name: ä¸Šä¼ boot.img
        uses: actions/upload-artifact@v4
        with:
          name: ${{ inputs.m }}-boot.zip
          path: |
            work/out/dist/boot.img
            work/out/dist/boot-gz.img
            work/out/dist/boot-lz4.img
